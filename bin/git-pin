#!/bin/bash
set -e

branch=$(git rev-parse --abbrev-ref HEAD)

if (( $# == 0 )); then
	git branch --set-upstream-to=$(git rev-parse --abbrev-ref --symbolic-full-name pin@{upstream})
	git branch -d pin
else
	upstream=$(git rev-parse --abbrev-ref --symbolic-full-name @{upstream})
	git branch --force pin $1
	git branch --set-upstream-to=$upstream pin
	git branch --set-upstream-to=pin
fi

git status
